// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Applicant {
  idDB                   Int          @id @default(autoincrement())
  idAuth0                String       @unique
  email                  String       @unique
  picture                String
  name                   String
  familyName             String
  age                    DateTime
  phone                  String
  location               String
  inProgressApplications Track[]
  currentLocation        String[] //google maps
  readyMove              Boolean
  workingHours           String
  workingModal           String
  socialMedia            String[]
  skillsProf             String[]
  stack                  String[]
  compLanguages          String[]
  about                  String
  video                  String
  education              Education[]
  experiences            Experience[]
  languages              String[]
  hobbies                String[]
  salaryRange            Int
  desiredLocation        String[]
  notDesiredLocation     String[]
  desiredWorkingModal    String
}

model Experience {
  id          Int       @id @default(autoincrement())
  jobTitle    String
  company     String
  startDate   DateTime
  endDate     DateTime
  description String
  applicant   Applicant @relation(fields: [applicantId], references: [idDB])
  applicantId Int
}

model Education {
  id            Int        @id @default(autoincrement())
  place         String
  startDate     DateTime
  endDate       DateTime
  degree        String
  speciality    String
  Applicant     Applicant? @relation(fields: [applicantIdDB], references: [idDB])
  applicantIdDB Int?
}

model Recruiter {
  id            Int       @id @default(autoincrement())
  name          String
  vacancies     Vacancy[]
  logo          String
  founded       String
  about         String
  externalLinks String[]
  headOffice    String
  Track         Track[]
}

model Vacancy {
  id                Int       @id @default(autoincrement())
  recruiter         Recruiter @relation(fields: [recruiterId], references: [id])
  recruiterId       Int
  about             String
  title             String
  jobTrack          Track[]
  workingHours      String
  workingModal      String
  skills            String[]
  stack             String[]
  requiredLanguages String[]
  experience        Int
  location          String
  salaryRange       Int
}

model Track {
  id          Int        @id @default(autoincrement())
  steps       Step[]
  recruiterID Int
  Recruiter   Recruiter  @relation(fields: [recruiterID], references: [id])
  applicantID Int?
  Applicant   Applicant? @relation(fields: [applicantID], references: [idDB])
  reject      Boolean    @default(false)
  notes       String?
  vacancyId   Int
  Vacancy     Vacancy    @relation(fields: [vacancyId], references: [id])
  Message     Message[]
}

model Step {
  id            Int           @id @default(autoincrement())
  title         String
  actions       Action[]
  durationInMs  Int
  hidden        Boolean
  statusStep    Boolean
  questionaries Questionary[]
  Track         Track?        @relation(fields: [trackId], references: [id])
  trackId       Int
}

model Message {
  id      Int      @id @default(autoincrement())
  trackId Int
  track   Track    @relation(fields: [trackId], references: [id])
  text    String
  date    DateTime
  files   String[]
  stepId  Int
}

model Action {
  id           Int    @id @default(autoincrement())
  action       Step   @relation(fields: [stepId], references: [id])
  stepId       Int
  name         String
  scheduleDate String
}

model Questionary {
  id        Int      @id @default(autoincrement())
  questions String[]
  answer    String[]
  date      DateTime
  Step      Step?    @relation(fields: [stepId], references: [id])
  stepId    Int?
}
